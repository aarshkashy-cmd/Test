<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>BOLTHEX | Admin</title>
    <style>
        body { background: #000; color: #fff; font-family: sans-serif; display: flex; align-items: center; justify-content: center; min-height: 100vh; margin: 0; }
        .login-card { background: #111; padding: 40px; border-radius: 15px; border: 1px solid #222; text-align: center; width: 320px; }
        input { width: 100%; padding: 12px; margin: 20px 0; background: #000; border: 1px solid #333; color: #fff; border-radius: 5px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background: #0ea5e9; border: none; color: #fff; font-weight: bold; border-radius: 5px; cursor: pointer; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <div id="login-screen" class="login-card">
        <h1 style="color:#0ea5e9; margin:0;">BOLTHEX</h1>
        <p style="color:#555; font-size:12px;">SYSTEM UNLOCK</p>
        <input type="password" id="token-input" placeholder="Paste GitHub Token">
        <button onclick="unlock()">Unlock</button>
    </div>

    <script>
        // 1. THE TRICK: Create a fake "empty" config file in memory
        // This prevents the "404 Failed to load config.yml" error
        const config = {
            backend: { name: "github", repo: "aarshkashy-cmd/Test", branch: "main" },
            media_folder: "photo",
            public_folder: "photo",
            collections: [{
                name: "gallery",
                label: "Gallery",
                folder: "photo",
                create: true,
                fields: [
                    {label: "Title", name: "title", widget: "string"},
                    {label: "Image", name: "image", widget: "image"}
                ]
            }]
        };

        const blob = new Blob([JSON.stringify(config)], { type: 'application/json' });
        window.CMS_CONFIG = config; 
        window.CMS_MANUAL_INIT = true;
    </script>

    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>

    <script>
        function unlock() {
            const token = document.getElementById('token-input').value.trim();
            if (!token) return alert("Enter Token First");

            localStorage.setItem('bolthex_token', token);
            document.getElementById('login-screen').classList.add('hidden');

            // 3. Re-initialize with the Token
            window.CMS.init({
                config: {
                    ...config,
                    backend: { ...config.backend, token: token }
                }
            });
        }

        // Auto-fill
        const savedToken = localStorage.getItem('bolthex_token');
        if (savedToken) document.getElementById('token-input').value = savedToken;
    </script>
</body>
</html>
